(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.locallyjs=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};if("string"==typeof val)return parse(val);return options.long?long(val):short(val)};function parse(str){str=""+str;if(str.length>1e4)return;var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}function short(ms){if(ms>=d)return Math.round(ms/d)+"d";if(ms>=h)return Math.round(ms/h)+"h";if(ms>=m)return Math.round(ms/m)+"m";if(ms>=s)return Math.round(ms/s)+"s";return ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(ms<n)return;if(ms<n*1.5)return Math.floor(ms/n)+" "+name;return Math.ceil(ms/n)+" "+name+"s"}},{}],2:[function(require,module,exports){"use strict";(function(){var ls=typeof window!=="undefined"?window.localStorage:null,ms=require("ms");if(!ls){ls={_data:{},setItem:function setItem(id,val){return this._data[id]=String(val)},getItem:function getItem(id){return this._data.hasOwnProperty(id)?this._data[id]:undefined},removeItem:function removeItem(id){return delete this._data[id]},key:function key(index){for(var key in this_data){if(!index--){return key}}},clear:function clear(){return this._data={}}}}var utils={each:function each(arr,iteratee){var l=arr.length;while(l--)iteratee(arr[l],l)},map:function map(arr,iteratee){var newArr=new Array(arr.length),l=arr.length;while(l--)newArr[l]=iteratee(arr[l],l);return newArr},filter:function filter(arr,iteratee){var newArr=[],l=arr.length;while(l--){if(iteratee(arr[l],l))newArr.push(iteratee)}return newArr}};var _keys,_config;var Locally=function Locally(options){_config=ls.getItem("locally-config");if(!_config){_config={};_keys=[];this.length=0}else{var l=ls.length;_config=JSON.parse(_config);_keys=new Array(l);while(l--){_keys[l]=ls.key(l);_config[_keys[l]]=_config[_keys[l]]||{}}_keys.splice(_keys.indexOf("locally-config"),1);this.length=_keys.length}_saveConfig=_saveConfig.bind(this);_remove=_remove.bind(this);_get=_get.bind(this);_saveConfig()};Locally.prototype.set=function(key,value,options){if(!key||!value)return new Error("no key or value given");options=options||{};if(typeof options!=="object"){options={ttl:options}}if(typeof options.ttl==="string"){options.ttl=ms(options.ttl)}_config[key]=_config[key]||{};if(_keys.indexOf(key)==-1){_keys.push(key);this.length=_keys.length}if(options.ttl&&!isNaN(options.ttl)){_config[key].ttl=Date.now()+options.ttl}else if(_config[key].ttl){delete _config[key].ttl}switch(typeof value){case"object":if(value instanceof Date){value=value.getTime();_config[key].t="d"}else if(value instanceof RegExp){value=value.toString();_config[key].t="r"}else{value=JSON.stringify(value);_config[key].t="o"}break;case"function":_config[key].t="f";break;case"number":_config[key].t="n";break;case"boolean":value=value?1:0;_config[key].t="b";break;case"string":default:_config[key].t="s"}ls.setItem(key,value);_saveConfig()};Locally.prototype.get=function(key){return Array.isArray(key)?utils.map(key,function(item){return _get(item)}.bind(this)):_get(key)};Locally.prototype.keys=function(pattern){if(!pattern||pattern=="*")return _keys.slice(0);if(!(pattern instanceof RegExp)){pattern=new RegExp(".*"+pattern+".*")}return utils.filter(_keys,function(key){return pattern.test(key)})};Locally.prototype.remove=function(key){if(typeof key==="undefined")throw new Error("'remove' requires a key");if(Array.isArray(key)){utils.each(key,_remove)}else{_remove(key)}};Locally.prototype.scan=function(key,fn){return utils.each(this.keys(key),fn)};Locally.prototype.ttl=function(key,returnString){return _config[key]?_config[key].ttl?!returnString?_config[key].ttl-Date.now():ms(_config[key].ttl-Date.now()):-1:-2};Locally.prototype.persist=function(key){return _config[key]?delete _config[key].ttl&&_saveConfig():false};Locally.prototype.expire=function(key,ttl){return _config[key]?!!(_config[key].ttl=Date.now()+ttl)&&_saveConfig():false};Locally.prototype.clear=function(){ls.clear();this.length=0;_config={};_keys=[];return _saveConfig()};Locally.prototype.key=function(index){return _keys[index]};function _remove(key){ls.removeItem(key);_keys.splice(_keys.indexOf(key),1);this.length=_keys.length}function _saveConfig(){ls.setItem("locally-config",JSON.stringify(_config));return true}function _get(key){if(typeof key==="undefined"||!_config[key])return null;if(_config[key].ttl<Date.now()){delete _config[key];_saveConfig();_remove(key);return null}var value=ls.getItem(key),temp;switch(_config[key].t){case"o":return JSON.parse(value);break;case"d":return new Date(parseInt(value,10));break;case"r":return new RegExp(value.substring(1,value.length-1));break;case"f":eval("temp = "+value);return temp;break;case"n":return Number(value);break;case"s":return String(value);break;case"b":return value=="1";break}return value}if(typeof exports==="object"){module.exports.Store=Locally}if(typeof define==="function"&&define.amd){define(function(){return{Store:Locally}})}if(typeof window==="object"){window.Locally={Store:Locally}}})()},{ms:1}]},{},[2])(2)});